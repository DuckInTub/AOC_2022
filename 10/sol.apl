+\⍎¨{i ← ⍸,↑(0=⍴)¨⍵ ⋄ ('0'@i)⍵}5↓¨d
((1+'a'=⊃)¨d)/+\¯1↓1,⍎¨{i ← ⍸,↑(0=⍴)¨⍵ ⋄ ('0'@i)⍵}5↓¨d

cyc ← 20 60 100 140 180 220

+/cyc×(⊂cyc)⌷n←((1+'a'=⊃)¨d)/+\¯1↓1,⍎¨{i ← ⍸,↑(0=⍴)¨⍵ ⋄ ('0'@i)⍵}5↓¨d

i ← ⍸2>6 40 ⍴|1+n-240⍴(⍳40)
('#'@i)6 40 ⍴ ' '